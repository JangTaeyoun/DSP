% FIR 저역통과 필터 설계 - 등맥동 최적 설계법

% 필터 사양
fs = 8000;              % 샘플링 주파수 (Hz)
N = 50;                 % 필터 차수 (계수 개수는 N+1 = 51)
fc_pass = 1200;         % 통과대역 경계
fc_stop = 1800;         % 차단대역 시작

% 정규화 주파수 계산
wp = fc_pass / (fs/2);  % 통과대역 정규화
ws = fc_stop / (fs/2);  % 차단대역 정규화

% 주파수 대역과 이상적 응답 정의
f = [0 wp ws 1];        % 주파수 벡터 (0~1 범위)
a = [1 1 0 0];           % 이상적 응답: 통과(1), 차단(0)
w = [1 10];              % 가중치: 차단대역 감쇠 강조

% FIR 필터 설계 (Parks-McClellan 알고리즘)
b_pm = firpm(N, f, a, w);

% 주파수 응답 시각화
figure;
freqz(b_pm, 1, 1024, fs);
title('FIR 저역통과 필터 - 등맥동 최적 설계법 (Parks-McClellan)');
